clear
SI_units

C = 15*pF;
L = 1.7*nH;

dC = 5*pF;

crt = FloquetCircuit();
crt.freq = linspace(0.001,3,301)*GHz;
crt.freq_mod = 2*GHz;
crt.N_orders = 1; 


t = linspace(0, 1./crt.freq_mod, 2^10);


add_capacitor(crt, 'CAP', C + dC*cos(2*pi*crt.freq_mod*t))
add_inductor(crt, 'IND', L);
add_pin(crt, 'PIN');

connect_by_ports(crt, 'PARAMETRIC', {'PIN','CAP','IND'}, {[2,3,5], [4,6,0]});

crt.analyze();


figure
hold on
plot_sparam_mag(crt, 'PARAMETRIC', {'S(1,1)'}, -1:1, 0, 'XUnits', 'GHz');
